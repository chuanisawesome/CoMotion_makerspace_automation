function sendEmails() {
   Logger.clear();
  // TODO: check all the variables to ensure they're correct
  var sheet = SpreadsheetApp.getActiveSheet();
  var startRow = 2; // Start at second row because first row contains the data labels
  var endRow = sheet.getLastRow(); // number of rows you want to process
  
  // TODO: these are the most likey ones that need to be changed
  var startCol = 1;
  var endCol = sheet.getLastColumn();

  // Fetch the range of cells A2:B1000
  // Column A = Email Address, Column B = First Name
  var data = sheet.getRange(startRow, startCol, endRow, endCol).getValues()
  
  var EMAIL_ADDRESS_COL = 0;
  var NAME_COL = 1; 
  var IS_PASSED_COL = 2;
  var IS_EMAILED_COL = 3; 
  var SCORE_COL = 4;
  
  for (var current_row = 0; current_row < data.length - 1; current_row++) {
   var row = data[current_row];
   var emailAddress = row[EMAIL_ADDRESS_COL];
   var name = row[NAME_COL];
   var is_emailed =  row[IS_EMAILED_COL]; 
   var is_passed = row[SCORE_COL]/30 >= 0.8 // 80 percent passing score
   
  // PART OF THESE Variables DEAL WITH COUNTING AT 0, AND PART OF THEM DEAL WITH COUNTING AT 1. SOLUTION?
  // Set these variables to prevent psychosis.
  
  var current_range_row = current_row + 2;
  var current_range_is_passed_col = IS_PASSED_COL + 1;
  var current_range_is_emailed_col = IS_EMAILED_COL + 1;
   
  var is_passed_cell = sheet.getRange(current_range_row, current_range_is_passed_col);
   
   // if there's nothing in the is_passed cell, then store if they passed or not in the is_passed cell
   if (is_passed_cell.getValue() == "") {
     is_passed_cell.setValue(is_passed);
   }
  
   
   if (!is_emailed && is_passed) {
   
      var subject = "Welcome to CoMotion MakerSpace!"; 
      var message = "Hey " + name + ",\n Congratulations! You successfully passed the MakerSpace quiz!\n Here are your next steps..."; // Assemble the body text
      MailApp.sendEmail(emailAddress, subject, message)
      sheet.getRange(current_range_row, current_range_is_emailed_col).setValue("true");
    }
   SpreadsheetApp.flush();
  }
}
